<!DOCTYPE html>
<html>
<head>

	<meta charset="UTF-8">
	<title>Task Manager</title>
	
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="js/main.js"></script>
		
	<script type="text/javascript">
		
	$(document).ready(function (){

		$.ajax({
			url: 'rest/task',
			type: 'GET',
			success: function(data) {
    			renderTable(data);            
			},
			error: function(e) {
				alert(e);
			}
		});
		
		$(document).on('click', '.clickableRow', function() {
			var taskID = $(this).find("#hiddenId").text();
			localStorage.setItem("currentTask", taskID);
			window.location.href = "task.html";
		});
	});
	
	function renderTable(data) {
		var tbody = $('#taskTable tbody');
		var tasks = data.task;
        for (i = 0; i < tasks.length; i++) {
        	debugger;
            tbody.append("<tr class='clickableRow'>" + 
            		"<td id='hiddenId' style='display: none'>" + tasks[i].taskID + "</td>" +
                    "<td>" + tasks[i].taskName + "</td>" +
                    "<td>" + tasks[i].description + "</td>" +
                    "<td>" + tasks[i].executor.username + "</td>" +
                    "<td>" + tasks[i].endDate + "</td>" + 
                    "<td>" + tasks[i].status + "</td>" + 
                    "</tr>");
        }
	}
	
	</script>
	
</head>
<body>

<div id="container">
	
	<div id="header">
	
		<span class="menuSpan" id="createTaskButton">
            <input value="Log out" type="button" class="menuButton" onClick="logout()" />
        </span>
	
	 	<span class="menuSpan" id="createTaskButton">
            <a href="createTask.html" class="menuButton"> Create New Task </a>
        </span>

        <span class="menuSpan" id="createUserButton">
            <a href="createUser.html" class="menuButton"> Create New User </a>
        </span>
        
        <span class="menuSpan" id="editProfileButton">
            <a href="editProfile.html" class="menuButton"> Edit Your Profile </a>
        </span>
        
        <span class="menuSpan" id="homeButton">
            <a href="tasks.html" class="menuButton"> Home </a>
        </span>
		
	</div>
	
	<div class="tableContainer">
	
	<table id="taskTable">
    	<thead>
    	<tr>
    	<th>Task name</th>
   		<th>Description</th>
   		<th>Executor</th>
    	<th>End date</th>
    	<th>Status</th>
    	</tr>
    	</thead>
    	<tbody>
    	
    	</tbody>
	</table>
	
	</div>	
	
</div>

</body>
</html>
